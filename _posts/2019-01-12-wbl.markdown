---
layout: paper-summary
title:  "Write-Behind Logging"
date:   2019-01-12 18:05:00 -0500
categories: paper
paper_title: "Write-Behind Logging"
paper_link: https://dl.acm.org/citation.cfm?id=3025116
paper_keyword: Logging; Durability; Transaction Processing; Database
paper_year: VLDB 2016
rw_set: 
htm_cd: 
htm_cr: 
version_mgmt: 
---

This paper proposes Write-Behind Logging (WBL), a novel technique that levarages Non-Volatile Memory (NVM) to solve 
the classical problem in databases: making transactions durable. In earlier works, people have proposed various schemes
to retain the consistency of database in cases of power failure (media failure and OS/DBMS failure are not considered,
because they usually corrupt data in an unpredicable manner that a recovery algorithm could not handle), where all 
in-memory works not flushed to durable storage are lost and there is no way to know which part of the database is consistent.
ARIES, as one example, uses both undo logging and redo logging to perform recovery. ARIES is intended for a disk-based 
database system with a managed buffer pool. To make it more realistic, two assumptions are made: First, dirty pages in 
the buffer pool may be written back to the disk at any time during transaction's execution. This assumption is made to
allow the buffer pool to swap in new pages when there is no free slot, as is the case with most buffer pool implementations.
As a consequence, before a transaction could commit, its dirty pages may overwrite valid data on the disk. On power failure,
the recovery algorithm must be able to recover the disk image to a state before the dirty pages were written out. The second
assumption is that dirty pages may not be flushed back to durable storage on transaction commit. This assumption improves 
transaction throughput, because for disk-based systems, writing dirty data back to the disk will most likely be random
writes, which can easily become the performance bottleneck. On recovery, the algorithm must be able to find back the 
committed values, even if they were not flushed to the disk before the crash. These two schemes, combined together,
is called "steal and no force". ARIES commit protocol is described as follows. During normal operations, the database monitors
write operations to the database. For each write, the physical before-image and after-image are both saved in the log. 
On transaction commit, the log record of the transaction must be flushed to the disk using fsync(). The transaction is 
considered as committed once fsync returns. Fuzzy checkpoints are also taken periodically to avoid log buffer overflow. The 
fuzzy checkpointing operation does not have to halt all transactions, and hence can complete faster than a synchronized 
checkpoint. Since uncommitted data may exist in fuzzy checkpoints, both redo and undo are needed to restore the 
database to a consistent state after a crash.