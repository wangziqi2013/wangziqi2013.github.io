---
layout: paper-summary
title:  "COSPlay: Leveraging Task-Level Parallelism for High-Throughput Synchronous Persistence"
date:   2021-10-28 21:10:00 -0500
categories: paper
paper_title: "COSPlay: Leveraging Task-Level Parallelism for High-Throughput Synchronous Persistence"
paper_link: https://dl.acm.org/doi/10.1145/3466752.3480075
paper_keyword: NVM; Persist Barrier; COSPlay
paper_year: MICRO 2021
rw_set:
htm_cd:
htm_cr:
version_mgmt:
---

**Comments:**

1. My biggest concern is that this mechanism require a few threads to be assigned to the same core for fast
   switch (b/c otherwise they will not share the same store buffer anyway). This would have serious performance
   implications because of resource contention. Servers typically only schedule less than two threads per core,
   making this technique inefficient.

This paper introduces Coroutines for Synchronous Persistence (COSPlay), a hardware-software co-design that exploits 
task-level parallelism from the software side, and virtualized write buffer on the hardware side, for improved 
persistence throughput. The paper is motivated by the fact that current support for persistence ordering on commercial 
processors is limited to per-core barriers that block all future store and flush operations while existing 
outstanding flushes are being served. This coarse-grained mechanism guarantees safety, but causes unnecessary 
pipeline stalls, since not all store and flush operations waiting to be executed are dependent on the current
persistent operation.
This paper proposes that: (1) Stores and flushes should be made context-tagged, and the store buffer holding committed
store operations should be virtualized such that entries from different contexts can be distinguished and processed
independently, which maximizes the throughput; (2) Application threads should be switched out while a persist
barrier is in effect, overlapping the persistence overhead with the execution of another thread.
