---
layout: paper-summary
title:  "ARIES: Atransaction Recivery Method Supporting Fine-Granularity Locking and Partial Rollbacks Using Write-Ahead Logging"
date:   2019-01-31 22:26:00 -0500
categories: paper
paper_title: "ARIES: Atransaction Recivery Method Supporting Fine-Granularity Locking and Partial Rollbacks Using Write-Ahead Logging"
paper_link: https://dl.acm.org/citation.cfm?id=128770
paper_keyword: ARIES; Recovery; Logging
paper_year: TODS 1992
rw_set: 
htm_cd: 
htm_cr: 
version_mgmt: 
--- 

This 69 page paper describes Algorithm for Recovery and Isolation Exploiting Semantics (ARIES) in great detail. ARIES 
is designed for providing durability to database transactions with fast recovery and low runtime overhead. ARIES also
requires less software engineering effort to adopt for an existing system, because it supports rich semantics and most
main stream database designs (as of the time the paper was published). We next describe the data structures and operations 
of ARIES.

ARIES requires two in-memory data structures to be maintained in the runtime. These two data structures are transaction
table (TT) which describes the commit state of transactions, and dirty page table (DPT). Neither of them is persisted 
to the disk except for performing checkpoints. During recovery, these two tables are recoverd by replaying log records 
since the last checkpoint. The transaction table, as stated above, stores information of currently active transactions
and their logging status. Typical fields include the transaction's commit progress (not yet committed, or waiting for log
records to be persisted), last log record written, and the next log record to undo if the transaction is halfway through
a partial or full rollback. The dirty page table stores information for dirty pages currently in the buffer pool. ARIES
only requires one field, the RecLSN (Recovery LSN), which is the smallest serial number of the log record that modifies the
page since the last write back of the same page. During normal processing, the entry is updated to the log record 
number whenever a page is loaded into the buffer pool for writing, or when a write operation causes the buffer pool 
entry to become dirty. If a page is evicted from the buffer pool, the corresponding entry is removed. During recovery,
however, the content of DPT does not strictly replicate the DPT before the failure. The reasoning behind is that ARIES
always use log entries as the ultimate reference for performing recovery. DPT, on the other hand, only acts as a filter 
that prevents most unnecessary I/O when they are truly avoidable. False positives are possible, but they only affect 
recovery speed instead of correctness.

ARIES maintains all log entries in a logically serial log. The actual implementation may partition the serial log into
multiple files. Each log entry has a Log Serial Number (LSN), which uniquely identifies: (1) The identity of the entry, and 
(2) The location of the entry in the log, which means that the content of the log entry can be found given the LSN. 
The LSN grows monotonically in all circumstances. A log entry may contain different information depending on its type.
We list them as follows. First, the log entry contains the entry's LSN, type and Transaction ID. These three fields
are common to all log entries. Most log entries also have a PrevLSN field, which stores the LSN of the previous log entry
written by the same transaction. The recovery routine could undo all uncommitted changes of a certain transaction by
repeatedly following the PrevLSN until a NULL value is seen, without having to scan the entire log. If the log entry
describes the modification to a page, it also has a page ID field, which stores the address that the modification is 
applied to. For log records generated during a rollback, a field UndoNextLSN stores the LSN of the next log entry that 
should be rolled back. This simplifies handling of transaction rollbacks, because the recovery routine only needs to 
use the most up-to-date entry to determine the next log entry from the same transaction that should be undone instead
of scanning the log backwards. The last field of log entries is data. For normal write operations during normal processing,
this field should contain both redo and undo information. For some log records, only redo information is present because 
they are part of the undo process, and cannot be undone.